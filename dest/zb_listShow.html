<!DOCTYPE html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="renderer" content="webkit"><!-- 国产双核浏览器，启用极速模式 -->
	<meta name="HandheldFriendly" content="true" />
	<meta name="MobileOptimized" content="320" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0" />
	<meta name="description" content="" />
	<meta name="author" content="" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Expires" content="-1">
	
	<meta http-equiv="Cache-Control" content="no-transform">
	<meta charset="utf-8">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-touch-fullscreen" content="yes">
	<meta name="full-screen" content="yes">
	<meta name="screen-orientation" content="portrait">
	<meta name="x5-fullscreen" content="true">
	<meta name="360-fullscreen" content="true">
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<meta name="mobile-web-app-status-bar-style" content="black" />
	<meta name="apple-touch-fullscreen" content="yes"/>
	<meta name="touch-fullscreen" content="yes"/>
	
    <title></title>
    <link rel="stylesheet" href="./res/css/base.css?v=f64bdde28d" />
    <link rel="stylesheet" href="./res/css/idangerous.swiper.css?v=a769a5281c" />
    <link rel="stylesheet" href="./res/css/main.css?v=da35df55cb" />
    <link rel="stylesheet" href="./res/css/zb_listShow.css?v=100b4dab66" />
    <style type="text/css">
		html,body{
			background-color: #fff;
		}
    </style>
    <script type="text/javascript">
    
    </script>
</head>
<body style="" class="overflowHidden">

	<div class="video-play-wrapper">
		<video id="videoView" poster="" src="http://video3.utvgo.com:17553/800/dongnanweishitv/yulelefantian/yllft20151119.mp4" controls webkit-playsinline="true" x-webkit-airplay></video>
		<div class="video-play-img"></div>
		<div class="video-play-play-icon"></div>
		<div class="video-top-bar">
			<button class="video-top-bar-back"></button>
			<div class="video-play-title ellipsis"></div>
		</div>
	</div>


	<div class="detailTabBox">
		<div class="detailTabBar col2 clearfix">
			<div class="detailTabItem on">
				<span class="detailTab-text">节目表</span>
			</div>
			<div class="detailTabItem">
				<span class="detailTab-text">回看</span>
			</div>
		</div>
		<div class="tabContentBoxWrapper">
			<div id="detailTabContentBox_0" class="detailTabContentBox overflow-scroll-y show">
				<div class="detailTabItemContent detail-jiList clearfix">
					<a href="#" class="detail-jiList-item">1</a>
				</div>
<!-- 				<ul id="weekBox" class=" weekBox ">
					<li class="weekItem on" >周四<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周五<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周六<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周日<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周一<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周二<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周三<br><span class="tvShowDate">07-30</span></li>
				</ul> -->
<!-- 				<ul id="tvListBox" class="tvListBox show">
					<li class="listItem on">
						<div class="icon"><b class="top"></b><b class="bottom"></b><i></i><span class="playTipsText">已结束</span></div>
						<div class="tvShowItem">
							<span class="tvShowtime">09:30&nbsp;&nbsp;海派甜心(24)</span>
						</div>
					</li>								
				</ul>
				<ul id="tvListBox" class="tvListBox">2</ul>
				<ul id="tvListBox" class="tvListBox">3</ul>
				<ul id="tvListBox" class="tvListBox">4</ul>
				<ul id="tvListBox" class="tvListBox">5</ul>
				<ul id="tvListBox" class="tvListBox">6</ul>
				<ul id="tvListBox" class="tvListBox">7</ul>	 -->		
			</div>
			<div id="detailTabContentBox_1" class="detailTabContentBox overflow-scroll-y ">
				<div class="detailTabItemContent detail-jiList clearfix">
					<a href="#" class="detail-jiList-item">1</a>
				</div>
<!-- 				<ul id="weekBox" class=" weekBox ">
					<li class="weekItem on" >周四<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周五<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周六<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周日<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周一<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周二<br><span class="tvShowDate">07-30</span></li>
					<li class="weekItem">周三<br><span class="tvShowDate">07-30</span></li>
				</ul> -->
<!-- 				<ul id="tvListBox" class="tvListBox show">
					<li class="listItem on">
						<div class="icon"><b class="top"></b><b class="bottom"></b><i></i><span class="playTipsText"></span></div>
						<div class="tvShowItem">
							<span class="tvShowtime">09:30&nbsp;&nbsp;海派甜心(24)</span>
						</div>
					</li>								
				</ul>
				<ul id="tvListBox" class="tvListBox">2</ul>
				<ul id="tvListBox" class="tvListBox">3</ul>
				<ul id="tvListBox" class="tvListBox">4</ul>
				<ul id="tvListBox" class="tvListBox">5</ul>
				<ul id="tvListBox" class="tvListBox">6</ul>
				<ul id="tvListBox" class="tvListBox">7</ul> -->
			</div>			
		</div>
		
	</div>

	<script type="text/javascript" src="./res/js/lib/zepto-1.1.6.js?v=8155cb4235"></script>
	<script type="text/javascript" src="./res/js/lib/fx.js?v=ca467e4b03"></script>
	<script type="text/javascript" src="./res/js/lib/fx_methods.js?v=2aabbf9887"></script>
	<script type="text/javascript" src="./res/js/lib/idangerous.swiper.js?v=e61af1cb6a"></script>

	<script type="text/javascript" src="./res/js/main.js?v=10ce419620"></script>
	<script>
var urlParaObj=getUrlPara();//contentId=31996
var playUrl=urlParaObj.playUrl||"";//contentId=31996
var contentId=urlParaObj.contentId||"";//contentId=31996
var playName=urlParaObj.playName||"";//contentId=31996

$(document).ready(function () {

	getTvShowList();
	getBackShowsList();
	window.document.title="playName";
	$("#videoView").attr("src",playUrl) ;
	
})

function getTvShowList(){
	req=$.ajax({
	  type: 'GET',
	  url: serverAddress+'/utvgoClient/interfaces/tvShow_listTvShow.action?tvId='+urlParaObj.contentId+'&userId=',
	  // data to be added to query string:
	  data: {},
	  // type of data we are expecting in return:
	  dataType: 'json',
	  success: function(data){
  		var _data=data.result||[];
	  	if (data.status==0) {
	  		renderTVShow(_data);
	  	};

	  },
	  error: function(xhr, type){
	    alert('network error!');
	  }
	});

}
function renderTVShow(dataArr){
	var contentBox= $("#detailTabContentBox_0");
	var _dataArr=dataArr;
	var _tvShowDate="";
	var _tvShows="";
	var _tvShowsItem="";
	var tvListBoxStr="";
	var _dateStr="";
	for (var i = 0,_dataLen=_dataArr.length; i < _dataLen; i++) {
	 	_tvShowDate=_dataArr[i].showDate.split("-").slice(1).join("-");
	 	_tvShows=_dataArr[i].tvShows;
	 	var day=['四','五','六','日','一','二','三'];
	 	_dateStr+='<li class="weekItem " >周'+day[i]+'<br><span class="tvShowDate">'+_tvShowDate+'</span></li>'; 
	 	for (var j = 0,_subListLen=_tvShows.length; j < _subListLen; j++) {
		 	var isOver=new Date(_tvShows[j].showTime.replace(/-/g, "/"))-new Date();
		 	if (isOver<0) {
		 		isOverClass="isOver";
		 		isOverTips="已结束";
		 	}else if (_tvShows[j].showId==contentId) {
		 		isOverClass="onPlay";
		 		isOverTips="正在<br>播放";
		 	}else{
		 		isOverClass="notStart";
		 		isOverTips="";
		 	};	

	 		_tvShowsItem+='<li data-showId="'+_tvShows[j].showId+'" class="listItem '+isOverClass+'"> <div class="icon "><b class="top"></b><b class="bottom"></b><i></i><span class="playTipsText">'+isOverTips+'</span></div> <div class="tvShowItem"> <span class="tvShowtime">'+_tvShows[j].showTime+'&nbsp;&nbsp;'+_tvShows[j].showName+'</span> </div> </li>';

	 	};
	 	
	 	tvListBoxStr+='<ul id="tvListBox" class="tvListBox">'+_tvShowsItem+'</ul>';
	 	_tvShowsItem="";
	 	// console.log(tvListBoxStr);

	 }; 
	 _dateStr='<ul id="weekBox" class=" weekBox ">'+_dateStr+'</ul>';
	 $(".detailTabContentBox").append(_dateStr);
	 $(" .weekBox  .weekItem").eq(0).addClass("on") ;
	 contentBox.append(tvListBoxStr);
	 $(".tvListBox").eq(0).addClass("show");
	 var _height=$(window).height()-260;
	 $(".tvListBox").height(_height);
	

}
//==================================================================
function getBackShowsList(){
	req=$.ajax({
	  type: 'GET',
	  url: serverAddress+'/utvgoClient/interfaces/tvShow_listPlayBackTvShow.action?tvId='+contentId+'&userId=',
	  // data to be added to query string:
	  data: {},
	  // type of data we are expecting in return:
	  dataType: 'json',
	  success: function(data){
  		var _data=data.result||[];
	  	if (data.status==0) {
	  		BackShowsList_render(_data);
	  	};

	  },
	  error: function(xhr, type){
	    alert('network error!');
	  }
	});

}

function BackShowsList_render(dataArr){
	var contentBox= $("#detailTabContentBox_1");
	var _dataArr=dataArr;
	var _tvShowDate="";
	var _tvShows="";
	var _tvShowsItem="";
	var tvListBoxStr="";
	for (var i = 0,_dataLen=_dataArr.length; i < _dataLen; i++) {
	 	_tvShowDate=_dataArr[i].showDate.split("-").slice(1).join("-");
	 	_tvShows=_dataArr[i].playBackShows;
	 	for (var j = 0,_subListLen=_tvShows.length; j < _subListLen; j++) {

	 		_tvShowsItem+='<li data-playurl="'+_tvShows[j].cliPlayUrl+'" data-showId="'+_tvShows[j].showId+'" class="listItem on"> <div class="icon "><b class="top"></b><b class="bottom"></b><i></i><span class="playTipsText"></span></div> <div class="tvShowItem"> <span class="tvShowtime">'+_tvShows[j].showTime+'&nbsp;&nbsp;'+_tvShows[j].showName+'</span> </div> </li>';

	 	};
	 	
	 	tvListBoxStr+='<ul id="tvListBox" class="tvListBox">'+_tvShowsItem+'</ul>';
	 	_tvShowsItem="";
	 	// console.log(tvListBoxStr);

	 }; 
	 contentBox.append(tvListBoxStr);
	 $(".tvListBox").eq(0).addClass("show");
	 $(".tvListBox").height(_height);

}


















$(document).on("touchstart",".detailTabItem ",function(){
	var _this=$(this);
	_this.addClass("on").siblings().removeClass("on");
	$(".detailTabContentBox").eq(_this.index()).addClass("show").siblings().filter(".detailTabContentBox").removeClass("show");
})
.on("touchstart",".weekItem",function(){
	var _this=$(this);
	_this.addClass("on").siblings().removeClass("on");	
	_this.parent().siblings().filter(".tvListBox").removeClass("show").eq(_this.index()).addClass("show");	
})
.on("touchstart","#detailTabContentBox_1 .listItem",function(){
	var _this=$(this);
	if (_this.hasClass("onPlay")) {
		return false;
	};
	$("#videoView").attr("src",_this.attr("data-playurl")) ;
	window.document.title="playName";	
	_this.addClass("onPlay").siblings().removeClass("onPlay").find(".playTipsText").html("");
	_this.find(".playTipsText").html("正在<br>播放");

})



function setPlayTipsText(el){

}

	</script>
</body>


</html>
