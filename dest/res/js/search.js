function hasDetailPage(e){for(var a=[10085,10086],t=0,n=a.length;t<n;t++)if(e==a[t])return!0;return!1}function getNewData(e){var e=e||"new";"new"==e?pageNo=1:pageNo++,"new"==e&&showLoading();var a=(parseInt(pageNo,10)-1)*pageSize,t=serverAddress+"/utvgoClient/tvutvgo/channel/ajaxList.action";ajaxMore=$.ajax({type:"GET",url:t,data:{supplierId:supplierId,channelId:channelId,keywords:keywords,pagesize:pageSize,"pager.offset":a,pageNo:pageNo,year:yearId,typeId:typeId,areaId:areaId},dataType:"json",success:function(a){hideLoading(),renderListData(a,e)},error:function(e,a){ajaxMore=null}})}function renderListData(e,a){for(var t="",n=e.pm.records||[],o=0,i=n.length;o<i;o++)n[o].tvgoImg.indexOf("http://")==-1&&(n[o].tvgoImg=imgBasePath+n[o].tvgoImg),hasDetailPage(n[o].channelId)?href="dyDetail.html?channelId="+n[o].channelId+"&contentId="+n[o].id+"&type="+(n[o].mediaNum>=2?"dsj":"dy"):href="./list_set.html?qdId="+n[o].id+"&qdName="+n[o].contentName,t+='<div class="commonList-item"> <a  data-href="'+href+'" class="commonList-item-link clearfix"> <div class="commonList-item-img"> <img src="'+n[o].tvgoImg+'" /> </div> <div class="commonList-item-text-wrapper"> <p class="commonList-item-text">'+n[o].contentName+'</p> <span class="commonList-item-type-text"><!--'+n[o].createTime.split(" ")[0]+"&nbsp;&nbsp;&nbsp;-->"+n[o].channelName+"</span> </div> </a> </div>";a&&"new"!=a?$("#listContentBox").append(t):$("#listContentBox").html(t),$(".nomore").length>0?$(".nomore").hide():$("#listContent").append('<div class="nomore">正在加载...</div>'),n.length<pageSize?($(".nomore").show().html("没有更多了!"),ajaxMore=!0):ajaxMore=null}$(".list-page-main").on("scroll",function(e){var a=$(this),t=a.scrollTop(),n=a.height();if(t+n-56+5>=$("#listContent").height()){if(ajaxMore)return;$(".nomore").length>0?$(".nomore").show().html("正在加载..."):$("#listContent").append('<div class="nomore">正在加载...</div>'),getNewData("more")}});var ajaxMore=null,channelId,pageNo,typeId,areaId,yearId,pageSize,supplierId,urlParaObj=getUrlPara();channelId=-1,supplierId=urlParaObj.supplierId||"",pageNo=1,typeId=0,areaId=0,yearId=0,pageSize=10;var keywords="";hideLoading(),$("#siteSearchCancelBt").on("tap",function(e){window.history.back()}),$("#siteSearchInput").focus(),keywords=$("#siteSearchInput").val(),keywords&&getNewData("new"),$("#siteSearchInput").on("input keyup",function(e){if(13==e.keyCode){if(keywords=$(this).val(),""==keywords)return void alert("请输入关键字搜索!");getNewData("new")}}),$("#listContentBox").on("tap",".commonList-item-link",function(e){window.location.href=$(this).attr("data-href")});