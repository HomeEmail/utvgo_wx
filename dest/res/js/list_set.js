function getNewData(e){var e=e||"new";"new"==e?pageNo=1:pageNo++,"new"==e&&showLoading();var a=(parseInt(pageNo,10)-1)*pageSize,t=serverAddress+"/utvgoClient/tvutvgo/channel/ajaxContentList.action";ajaxMore=$.ajax({type:"GET",url:t,data:{supplierId:supplierId,boxId:qdId,pagesize:pageSize,"pager.offset":a,pageNo:pageNo,year:yearId,typeId:typeId,areaId:areaId},dataType:"json",success:function(a){hideLoading(),renderListData(a.pm.records||[],e,a.pm.total)},error:function(e,a){ajaxMore=null}})}function renderListData(e,a,t){for(var o="",e=e||[],n=0,r=e.length;r>n;n++)-1==e[n].tvgoImg.indexOf("http://")&&(e[n].tvgoImg=imgBasePath+e[n].tvgoImg),o+='<div class="commonList-item"> <a data-remark="'+e[n].remark+'" data-href="./play_sn.html?playName='+encodeURIComponent(e[n].recommendContentName||e[n].contentName)+"&playUrl="+encodeURIComponent(e[n].playUrl||e[n].tvgoPlayurl)+"&playImg="+encodeURIComponent(e[n].tvgoImg)+"&currentIndex="+n+"&boxId="+qdId+"&channelId="+e[n].channelId+"&contentId="+encodeURIComponent(e[n].contentId)+"&col=3&type="+encodeURIComponent("qi")+"&mediaNumber="+encodeURIComponent(t)+'" class="commonList-item-link clearfix"> <div class="commonList-item-img"> <img src="'+e[n].tvgoImg+'" /> </div> <div class="commonList-item-text-wrapper"> <p class="commonList-item-text">'+(e[n].recommendContentName||e[n].contentName)+'</p> <span class="commonList-item-type-text"><!--'+e[n].createTime.split(" ")[0]+"&nbsp;&nbsp;&nbsp;-->"+e[n].typeName+"</span> </div> </a> </div>";a&&"new"!=a?($("#listContentBox").append(o),playList=playList.concat(e)):($("#listContentBox").html(o),playList=e);try{localStorage.setItem("playList",JSON.stringify(playList))}catch(i){}$(".nomore").length>0?$(".nomore").hide():$("#listContent").append('<div class="nomore">正在加载...</div>'),e.length<pageSize?($(".nomore").show().html("没有更多了!"),ajaxMore=!0):ajaxMore=null}$(".list-page-main").on("scroll",function(e){var a=$(this),t=a.scrollTop(),o=a.height();if(t+o-46+5>=$("#listContent").height()){if(ajaxMore)return;$(".nomore").length>0?$(".nomore").show().html("正在加载..."):$("#listContent").append('<div class="nomore">正在加载...</div>'),getNewData("more")}});var ajaxMore=null,qdId,pageNo,typeId,areaId,yearId,pageSize,supplierId,spName,qdName,urlParaObj=getUrlPara();qdId=urlParaObj.qdId||"",supplierId=urlParaObj.supplierId||"",spName=urlParaObj.spName||"",qdName=urlParaObj.qdName||"",pageNo=1,typeId=0,areaId=0,yearId=0,pageSize=10;var typeName="全部类型";qdName&&$(".topNav-title").html(qdName),getNewData("new");var playList=[];$("#listContentBox").on("tap",".commonList-item-link",function(e){var a=$(this).attr("data-remark");try{localStorage.setItem("videoRemark",a)}catch(t){}window.location.href=$(this).attr("data-href")});