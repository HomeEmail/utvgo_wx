function getTypeData(){$.ajax({type:"GET",url:serverAddress+"/utvgoClient/interfaces/hdtvContent_typeContext.action",data:{channelId:channelId,pageSize:pageSize,pageNo:pageNo,publishYear:yearId,typeId:typeId,areaId:areaId},dataType:"json",success:function(e){hideLoading(),renderTypeData(e),getNewData("new")},error:function(e,i){alert("network error!")}})}function renderTypeData(e){var i="",t=[],a=0,s=0,r="",p="";for(i+='<div id="listType-type" class="listType-row listType-type swiper-container"><div class="swiper-wrapper">',t=e.result.dyTypes||[],a=0,s=t.length;s>a;a++)r=t[a].typeName,p="全部类型"==r?"on":"",i+='<div class="swiper-slide listType-item '+p+'" data-id="'+t[a].typeId+'"><div class="listType-item-text">'+r+"</div></div>";for(i+="</div></div>",i+='<div id="listType-area" class="listType-row listType-area swiper-container"><div class="swiper-wrapper">',t=e.result.areaList||[],a=0,s=t.length;s>a;a++)r=t[a].areaName,"全部类型"==r||"全部地区"==r?(r="全部地区",p="on"):p="",i+='<div class="swiper-slide listType-item '+p+'" data-id="'+t[a].areaId+'"><div class="listType-item-text">'+r+"</div></div>";for(i+="</div></div>",i+='<div id="listType-year" class="listType-row listType-year swiper-container"><div class="swiper-wrapper">',t=e.result.publishYears||[],a=0,s=t.length;s>a;a++)r=t[a],0==r?(r="全部年份",p="on"):p="",i+='<div class="swiper-slide listType-item '+p+'" data-id="'+t[a]+'"><div class="listType-item-text">'+r+"</div></div>";i+="</div></div>",$("#listTypeBox").html(i),i=i.replace('id="listType-type"','id="listType-type-fixed"'),i=i.replace('id="listType-area"','id="listType-area-fixed"'),i=i.replace('id="listType-year"','id="listType-year-fixed"'),$("#listTypeBoxFixed").html(i),initListTypeSwiper()}function initListTypeEvent(){$(".listType-type .listType-item").on("tap",function(e){typeId=$(this).attr("data-id"),$(".listType-type .listType-item.on").removeClass("on"),$(this).addClass("on"),getNewData("new")}),$(".listType-area .listType-item").on("tap",function(e){areaId=$(this).attr("data-id"),$(".listType-area .listType-item.on").removeClass("on"),$(this).addClass("on"),getNewData("new")}),$(".listType-year .listType-item").on("tap",function(e){yearId=$(this).attr("data-id"),$(".listType-year .listType-item.on").removeClass("on"),$(this).addClass("on"),getNewData("new")})}function getNewData(e){var e=e||"new";"new"==e?pageNo=1:pageNo++,showLoading(),ajaxMore=$.ajax({type:"GET",url:serverAddress+"/utvgoClient/interfaces/hdtvContent_listChannelData.action",data:{channelId:channelId,pageSize:pageSize,pageNo:pageNo,publishYear:yearId,typeId:typeId,areaId:areaId},dataType:"json",success:function(i){ajaxMore=null,hideLoading(),renderListData(i.result,e)},error:function(e,i){ajaxMore=null,alert("network error!")}})}function renderListData(e,i){for(var t="",a=0,s=e.length;s>a;a++)t+='<div class="rmdy-item"><a href="dyDetail.html?contentId='+e[a].id+"&type="+(e[a].type||"dy")+'" class="rmdy-item-link"><img src="'+e[a].img+'" /><p class="rdzx-text ellipsis">'+e[a].name+"</p></a></div>";i&&"new"!=i?$("#listContentBox").append(t):$("#listContentBox").html(t),$(".nomore").hide(),e.length<pageSize&&$(".nomore").show().html("没有更多了!")}function updateListTypeFixedSwiper(){listTypeTypeFixed.reInit(),listTypeAreaFixed.reInit(),listTypeYearFixed.reInit()}function initListTypeSwiper(){listTypeType=new Swiper("#listType-type",{paginationClickable:!0,slidesPerView:"auto",freeMode:!0}),listTypeArea=new Swiper("#listType-area",{paginationClickable:!0,slidesPerView:"auto",freeMode:!0}),listTypeYear=new Swiper("#listType-year",{paginationClickable:!0,slidesPerView:"auto",freeMode:!0}),listTypeTypeFixed=new Swiper("#listType-type-fixed",{paginationClickable:!0,slidesPerView:"auto",freeMode:!0}),listTypeAreaFixed=new Swiper("#listType-area-fixed",{paginationClickable:!0,slidesPerView:"auto",freeMode:!0}),listTypeYearFixed=new Swiper("#listType-year-fixed",{paginationClickable:!0,slidesPerView:"auto",freeMode:!0})}$(".list-page-main").on("scroll",function(e){var i=$(this),t=i.scrollTop(),a=i.height();if(136>=t?($(".listTypeBox").show(),$(".listTypeBox.fixed").hide(),$(".listTypeSelectedBox").hide()):($(".listTypeBox").hide(),$(".listTypeSelectedBox").show()),t+a-46+5>=$("#listContent").height()){if(ajaxMore)return;if($(".nomore").length>0)return void $(".nomore").show().html("正在加载...");$("#listContent").append('<div class="nomore">正在加载...</div>'),getNewData("more")}});var ajaxMore=null;$(".listTypeSelectedBox").on("tap",function(e){e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation(),$(this).hide(),$(".listTypeBox.fixed").show(),updateListTypeFixedSwiper()});var channelId,pageNo,typeId,areaId,yearId,pageSize,urlParaObj=getUrlPara();channelId=urlParaObj.channelId,pageNo=1,typeId=0,areaId=0,yearId=0,pageSize=10,getTypeData();var listTypeType,listTypeArea,listTypeYear,listTypeTypeFixed,listTypeAreaFixed,listTypeYearFixed;